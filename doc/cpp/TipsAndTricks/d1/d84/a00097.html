<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>C++ Tips and Tricks: Visitor Design Pattern</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">C++ Tips and Tricks<span id="projectnumber">&#160;2.00</span>
   </div>
   <div id="projectbrief">C++</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d1/d84/a00097.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Visitor Design Pattern</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="VISITOR_INTRO"></a>
Въведение</h1>
<p>Патернът Visitor позволява да се добавят нови операции към обекти от съществуващи класове, без да се променят тези класове. Това се постига чрез създаване на нов клас, който представлява операцията, която ще бъде изпълнена. Обектите от съществуващите класове приемат обекта на новия клас и го "посещават", като по този начин позволяват изпълнението на новата операция.</p>
<h1><a class="anchor" id="VISITOR_EXAMPLE"></a>
Пример</h1>
<p>Пример за използване на патерна Visitor:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>Visitor;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>Element {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">virtual</span> ~Element() = <span class="keywordflow">default</span>;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> accept(Visitor &amp;visitor) = 0;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>ConcreteElementA : <span class="keyword">public</span> Element {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keywordtype">void</span> accept(Visitor &amp;visitor) <span class="keyword">override</span>;</div>
<div class="line">    <span class="keywordtype">void</span> operationA()<span class="keyword"> const </span>{</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;ConcreteElementA operation.\n&quot;</span>;</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>ConcreteElementB : <span class="keyword">public</span> Element {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keywordtype">void</span> accept(Visitor &amp;visitor) <span class="keyword">override</span>;</div>
<div class="line">    <span class="keywordtype">void</span> operationB()<span class="keyword"> const </span>{</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;ConcreteElementB operation.\n&quot;</span>;</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>Visitor {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">virtual</span> ~Visitor() = <span class="keywordflow">default</span>;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> visitConcreteElementA(ConcreteElementA *element) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> visitConcreteElementB(ConcreteElementB *element) = 0;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>ConcreteVisitor1 : <span class="keyword">public</span> Visitor {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keywordtype">void</span> visitConcreteElementA(ConcreteElementA *element)<span class="keyword"> override </span>{</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;ConcreteVisitor1 visiting ConcreteElementA.\n&quot;</span>;</div>
<div class="line">        element-&gt;operationA();</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">void</span> visitConcreteElementB(ConcreteElementB *element)<span class="keyword"> override </span>{</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;ConcreteVisitor1 visiting ConcreteElementB.\n&quot;</span>;</div>
<div class="line">        element-&gt;operationB();</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>ConcreteVisitor2 : <span class="keyword">public</span> Visitor {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keywordtype">void</span> visitConcreteElementA(ConcreteElementA *element)<span class="keyword"> override </span>{</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;ConcreteVisitor2 visiting ConcreteElementA.\n&quot;</span>;</div>
<div class="line">        element-&gt;operationA();</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">void</span> visitConcreteElementB(ConcreteElementB *element)<span class="keyword"> override </span>{</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;ConcreteVisitor2 visiting ConcreteElementB.\n&quot;</span>;</div>
<div class="line">        element-&gt;operationB();</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> ConcreteElementA::accept(Visitor &amp;visitor) {</div>
<div class="line">    visitor.visitConcreteElementA(<span class="keyword">this</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> ConcreteElementB::accept(Visitor &amp;visitor) {</div>
<div class="line">    visitor.visitConcreteElementB(<span class="keyword">this</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> clientCode(std::vector&lt;std::unique_ptr&lt;Element&gt;&gt; &amp;elements, Visitor &amp;visitor) {</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;element : elements) {</div>
<div class="line">        element-&gt;accept(visitor);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    std::vector&lt;std::unique_ptr&lt;Element&gt;&gt; elements;</div>
<div class="line">    elements.push_back(std::make_unique&lt;ConcreteElementA&gt;());</div>
<div class="line">    elements.push_back(std::make_unique&lt;ConcreteElementB&gt;());</div>
<div class="line"> </div>
<div class="line">    ConcreteVisitor1 visitor1;</div>
<div class="line">    clientCode(elements, visitor1);</div>
<div class="line"> </div>
<div class="line">    ConcreteVisitor2 visitor2;</div>
<div class="line">    clientCode(elements, visitor2);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p>В този пример, класовете <code>ConcreteElementA</code> и <code>ConcreteElementB</code> приемат обект на клас <code>Visitor</code> и извикват съответния метод за посещение. Класовете <code>ConcreteVisitor1</code> и <code>ConcreteVisitor2</code> имплементират различни операции, които могат да бъдат изпълнени върху елементите.   </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../index.html">Tips and Tricks in C++</a></li><li class="navelem"><a class="el" href="../../db/db6/a00074.html">Design Patterns in C++</a></li>
    <li class="footer">Generated on Fri Jan 10 2025 20:14:12 for C++ Tips and Tricks by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
