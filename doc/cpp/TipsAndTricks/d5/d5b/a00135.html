<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>C++ Tips and Tricks: Visitor Design Pattern</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">var page_layout=1;</script>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(function() { init_search(); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="side-nav" class="ui-resizable side-nav-resizable"><!-- do not remove this div, it is closed by doxygen! -->
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">C++ Tips and Tricks<span id="projectnumber">&#160;2.00</span>
   </div>
   <div id="projectbrief">C++</div>
  </td>
 </tr>
   <tr><td colspan="2">        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect" class="search-icon" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"><span class="search-icon-dropdown"></span></span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><div id="MSearchCloseImg" class="close-icon"></div></a>
          </span>
        </div>
</td></tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
</div><!-- top -->
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('d5/d5b/a00135.html','../../',''); });
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',false,false,'search.php','Search',true);
});
</script>
<div id="main-nav"></div>
<div id="container"><div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Visitor Design Pattern </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1 class="doxsection"><a class="anchor" id="VISITOR_INTRO"></a>
Въведение</h1>
<p>Патернът Visitor позволява да се добавят нови операции към обекти от съществуващи класове, без да се променят тези класове. Това се постига чрез създаване на нов клас, който представлява операцията, която ще бъде изпълнена. Обектите от съществуващите класове приемат обекта на новия клас и го "посещават", като по този начин позволяват изпълнението на новата операция.</p>
<h1 class="doxsection"><a class="anchor" id="VISITOR_EXAMPLE"></a>
Пример</h1>
<p>Пример за използване на патерна Visitor:</p>
<div class="fragment"><div class="line">#include &lt;iostream&gt;</div>
<div class="line">#include &lt;vector&gt;</div>
<div class="line">#include &lt;memory&gt;</div>
<div class="line"> </div>
<div class="line">class Visitor;</div>
<div class="line"> </div>
<div class="line">class Element {</div>
<div class="line">public:</div>
<div class="line">    virtual ~Element() = default;</div>
<div class="line">    virtual void accept(Visitor &amp;visitor) = 0;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">class ConcreteElementA : public Element {</div>
<div class="line">public:</div>
<div class="line">    void accept(Visitor &amp;visitor) override;</div>
<div class="line">    void operationA() const {</div>
<div class="line">        std::cout &lt;&lt; &quot;ConcreteElementA operation.\n&quot;;</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">class ConcreteElementB : public Element {</div>
<div class="line">public:</div>
<div class="line">    void accept(Visitor &amp;visitor) override;</div>
<div class="line">    void operationB() const {</div>
<div class="line">        std::cout &lt;&lt; &quot;ConcreteElementB operation.\n&quot;;</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">class Visitor {</div>
<div class="line">public:</div>
<div class="line">    virtual ~Visitor() = default;</div>
<div class="line">    virtual void visitConcreteElementA(ConcreteElementA *element) = 0;</div>
<div class="line">    virtual void visitConcreteElementB(ConcreteElementB *element) = 0;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">class ConcreteVisitor1 : public Visitor {</div>
<div class="line">public:</div>
<div class="line">    void visitConcreteElementA(ConcreteElementA *element) override {</div>
<div class="line">        std::cout &lt;&lt; &quot;ConcreteVisitor1 visiting ConcreteElementA.\n&quot;;</div>
<div class="line">        element-&gt;operationA();</div>
<div class="line">    }</div>
<div class="line">    void visitConcreteElementB(ConcreteElementB *element) override {</div>
<div class="line">        std::cout &lt;&lt; &quot;ConcreteVisitor1 visiting ConcreteElementB.\n&quot;;</div>
<div class="line">        element-&gt;operationB();</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">class ConcreteVisitor2 : public Visitor {</div>
<div class="line">public:</div>
<div class="line">    void visitConcreteElementA(ConcreteElementA *element) override {</div>
<div class="line">        std::cout &lt;&lt; &quot;ConcreteVisitor2 visiting ConcreteElementA.\n&quot;;</div>
<div class="line">        element-&gt;operationA();</div>
<div class="line">    }</div>
<div class="line">    void visitConcreteElementB(ConcreteElementB *element) override {</div>
<div class="line">        std::cout &lt;&lt; &quot;ConcreteVisitor2 visiting ConcreteElementB.\n&quot;;</div>
<div class="line">        element-&gt;operationB();</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">void ConcreteElementA::accept(Visitor &amp;visitor) {</div>
<div class="line">    visitor.visitConcreteElementA(this);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">void ConcreteElementB::accept(Visitor &amp;visitor) {</div>
<div class="line">    visitor.visitConcreteElementB(this);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">void clientCode(std::vector&lt;std::unique_ptr&lt;Element&gt;&gt; &amp;elements, Visitor &amp;visitor) {</div>
<div class="line">    for (auto &amp;element : elements) {</div>
<div class="line">        element-&gt;accept(visitor);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">int main() {</div>
<div class="line">    std::vector&lt;std::unique_ptr&lt;Element&gt;&gt; elements;</div>
<div class="line">    elements.push_back(std::make_unique&lt;ConcreteElementA&gt;());</div>
<div class="line">    elements.push_back(std::make_unique&lt;ConcreteElementB&gt;());</div>
<div class="line"> </div>
<div class="line">    ConcreteVisitor1 visitor1;</div>
<div class="line">    clientCode(elements, visitor1);</div>
<div class="line"> </div>
<div class="line">    ConcreteVisitor2 visitor2;</div>
<div class="line">    clientCode(elements, visitor2);</div>
<div class="line"> </div>
<div class="line">    return 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p>В този пример, класовете <span class="tt">ConcreteElementA</span> и <span class="tt">ConcreteElementB</span> приемат обект на клас <span class="tt">Visitor</span> и извикват съответния метод за посещение. Класовете <span class="tt">ConcreteVisitor1</span> и <span class="tt">ConcreteVisitor2</span> имплементират различни операции, които могат да бъдат изпълнени върху елементите.   </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="../../index.html">DESIGN_PATTERNS Design Patterns in C++</a></li>
    <li class="footer">Generated on <span class="timestamp"></span> for C++ Tips and Tricks by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
